function bildFilter(){let e=$(this).attr("id"),t=parseInt(e.replace(/\D+/gi,"")),n=e.split("_")[0],o=filterItems[t].checkbox,i=filterItems[t].spancheckbox,r=filterItems[t].dropdown,a=n+"_filterwidget"+t,d="fs_"+n+"_hideFilter"+t;$("<label>",{class:"checkbox-inline pull-right clearfix",for:d,append:$("<input>",{type:"checkbox",class:"hide",name:d,id:d,checked:!!($.inArray(d,FILTERSETTINGS)+1),"data-toggle":"collapse","data-target":"#"+a}).add($("<i>",{class:"fa fa-angle-double-down fa-lg","aria-hidden":"true"}))}).appendTo(this);let s=$.inArray(d,FILTERSETTINGS)+1?"in":"",c=$("<div>",{class:"form-group form-inline collapse "+s,id:a});c.appendTo(this);let l=n+"_search"+t,u=n+"_btnSearch"+t,p=n+"_btnResetSearch"+t;$("<label>",{for:l,text:filterItems[t].title,style:"margin-left:1px;"}).appendTo(c),$("<input>",{type:"text",name:l,placeholder:"Filter...",class:"form-control",id:l,style:"margin-left:1px;"}).appendTo(c),$("<button>",{id:p,type:"button",class:"btn btn-default",append:$("<i>",{class:"fa fa-times","aria-hidden":"true"}),style:"margin-left:1px;"}).appendTo(c),$("<button>",{id:u,type:"button",class:"btn btn-default",append:$("<i>",{class:"fa fa-search","aria-hidden":"true"}),style:"margin-left:1px;"}).appendTo(c);let g=$("<div>",{class:"btn-group dropdown-events"});g.appendTo(c),$("<button>",{type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",text:filterItems[t].button,append:$("<span>",{class:"caret"}),style:"margin-left:1px;"}).appendTo(g);let h=$("<ul>",{class:"dropdown-menu"});for(var f in h.appendTo(g),r){let e=$("<li>").appendTo(h);$("<a>",{id:"f_"+n+t+"_"+f,href:"#",text:r[f]}).appendTo(e)}for(var f in $("<span>",{id:n+"_matches"+t,class:"badge"}).appendTo(c),o){let e="fs_"+n+"_"+f+t;$("<input>",{type:"checkbox",name:e,id:e,checked:!!($.inArray(e,FILTERSETTINGS)+1),style:"margin-left:1rem;"}).appendTo(c),$("<label>",{for:e,style:"padding-top:0px; margin-left:1px; font-weight:normal;",text:o[f]}).appendTo(c)}$("<div>",{class:"ajax-loader",append:$("<img>",{src:"view/javascript/fancytree/skin-win7/loading.gif",id:"loadImg"+t,style:"z-index:1000; display:none;"})}).appendTo(c);let m=$("<div>",{id:n+"_searchmode"+t,style:"margin-top:1em;"});for(var f in m.appendTo(c),i){let e="fs_"+n+"_"+f+t;$("<input>",{type:"checkbox",name:e,id:e,checked:!!($.inArray(e,FILTERSETTINGS)+1),style:"margin-left:1rem;"}).appendTo(m),$("<label>",{for:e,style:"padding-top:0px; margin-left:1px; font-weight:normal;",text:i[f]}).appendTo(m)}}function ClearFilter(e){e.isFilterActive()&&(e.clearFilter(),$('input[name *= "search"]').val(""),$('span[id *= "matches"]').text(""),$("[id ^=loadImg]").hide())}function reactivateCategory(){let e=0!==arguments.length?arguments[0]:null;CATEGORY_TREE.each(function(t,n){const o=$("#"+n.id).fancytree("getTree");let i=null!==e?e:o.getActiveNode();null!=i&&(o.getNodeByKey(i.key).setActive(!1),o.getNodeByKey(i.key).setActive(!0))})}function reloadAttribute(){if(0==arguments.length)ATTRIBUTE_SYNCRO_TREES.each(function(e,t){const n=$("#"+t.id).fancytree("getTree");let o=n.getActiveNode();ClearFilter(n),n.options.source.data.cache=$('input[name = "attributico_cache"]:checkbox').is(":checked"),n.reload().done(function(){n.options.source.data.isPending=!1,null!==o&&n.getNodeByKey(o.key).setActive(!0)})});else{var e=arguments[0],t=arguments[1];ATTRIBUTE_SYNCRO_TREES.each(function(n,o){var i=$("#"+o.id).fancytree("getTree");i.options.source.data.cache=$('input[name = "attributico_cache"]:checkbox').is(":checked"),(i!==e.tree||t)&&(ClearFilter(i),i.reload().done(function(){i.options.source.data.isPending=!1;var t=i.getNodeByKey(e.key);t&&void 0!==t&&t.setActive()}))}),t||e.setActive()}}function getSelectedKeys(e){var t=[];return e&&e.forEach(function(e){t.push(e.key)}),t}function getSelectedTitles(e){var t=[];return e&&e.forEach(function(e){t.push(e.title)}),t}function deSelectNodes(e){selNodes&&selNodes.forEach(function(e){e.setSelected(!1)}),selNodes=null}function selectControl(e){return e.node.isTopLevel()?(e.node.setSelected(!1),!1):(e.node.tree.visit(function(t){e.node.getLevel()!==t.getLevel()&&t.setSelected(!1)}),!0)}function addAttribute(e,t,n){for(var o=e,i="attribute"===t?2:1;o.getLevel()>i;)o=o.getParent();$.ajax({data:{user_token:user_token,token:token,key:o.key,name:"attribute"===t?textNewAttribute:textNewGroup},url:"index.php?route="+extension+"module/attributico/addAttribute",success:function(e){o.editCreateNode("child",{title:"attribute"===t?textNewAttribute[n]:textNewGroup[n],key:t+"_"+e,folder:"group"===t})}})}function deleteAttribute(e){let t=e.getLevel();if(2===t||3===t||5===t){var n=e.findUnselectedSibling();$.ajax({data:{user_token:user_token,token:token,keys:selNodes?getSelectedKeys(selNodes):[e.key],titles:selNodes?getSelectedTitles(selNodes):[e.title],language_id:e.getLanguageId()},url:"index.php?route="+extension+"module/attributico/deleteAttributes",success:function(){selNodes?$.each(selNodes,function(e,t){t.remove()}):e.remove(),reloadAttribute(n,5===t),selNodes=null}})}}function copyAttributes(e){var t=e.getParentByKey("group")||e.getParentByKey("category");t.key.indexOf("group")+1&&$.ajax({data:{user_token:user_token,token:token,target:t.key,attributes:clipboardTitles},url:"index.php?route="+extension+"module/attributico/addAttributes",success:function(){reloadAttribute(e,!0)}}),t.key.indexOf("category")+1&&$.ajax({data:{attributes:selNodes?getSelectedKeys(selNodes):[clipboardNodes[0][1].key],category_id:t.key,categories:selCategories?getSelectedKeys(selCategories):[t.key]},url:"index.php?route="+extension+"module/attributico/addCategoryAttributes&user_token="+user_token+"&token="+token,type:"POST",success:function(){reactivateCategory(t)}})}function deleteAttributesFromCategory(e){var t=e.getParent().key;$.ajax({data:{attributes:selNodes?getSelectedKeys(selNodes):[e.key],category_id:t,categories:selCategories?getSelectedKeys(selCategories):[t]},url:"index.php?route="+extension+"module/attributico/deleteAttributesFromCategory&user_token="+user_token+"&token="+token,type:"POST",success:function(){reactivateCategory(),reloadAttribute(e,!0)}}),selNodes=null}function addAttributeToCategory(e,t,n){$.ajax({data:{attributes:selNodes?getSelectedKeys(selNodes):[t.otherNode.key],category_id:e.key,categories:selCategories?getSelectedKeys(selCategories):[e.key]},url:"index.php?route="+extension+"module/attributico/addCategoryAttributes&user_token="+user_token+"&token="+token,type:"POST"}).done(function(){n?deleteAttributesFromCategory(t.otherNode):(deSelectNodes(t.otherNode),t.otherNode.tree.visit(function(e){e.isLazy()&&e.load(!0)}),reactivateCategory(e),reloadAttribute(t.otherNode,!1))})}function deleteDuty(e){$.ajax({data:{user_token:user_token,token:token,key:e.key,language_id:e.getLanguageId(),name:""},url:"index.php?route="+extension+"module/attributico/editAttribute",success:function(){reloadAttribute(e,!0)}})}function copyPaste(e,t){switch(e){case"cut":case"copy":pasteMode=e,selNodes?selNodes.forEach(function(e,t){clipboardNodes[t]=[],clipboardTitles[t]=[],ATTRIBUTE_GROUP_TREE.each(function(n,o){var i=$("#"+o.id).fancytree("getTree"),r=parseInt(o.id.replace(/\D+/gi,""));clipboardNodes[t][r]=i.getNodeByKey(e.key),clipboardTitles[t][r]=i.getNodeByKey(e.key).title})}):(clipboardNodes[0]=[],clipboardTitles[0]=[],ATTRIBUTE_GROUP_TREE.each(function(e,n){var o=$("#"+n.id).fancytree("getTree"),i=parseInt(n.id.replace(/\D+/gi,""));clipboardNodes[0][i]=o.getNodeByKey(t.key),clipboardTitles[0][i]=o.getNodeByKey(t.key).title}));break;case"paste":if(0==clipboardNodes.length){alert("Clipoard is empty.");break}"cut"==pasteMode?(copyAttributes(t,clipboardTitles),clipboardNodes[indx].remove()):copyAttributes(t,clipboardTitles),clipboardNodes=[],clipboardTitles=[],pasteMode=null;break;default:alert("Unhandled clipboard action '"+e+"'")}}function initTrees(){ATTRIBUTE_GROUP_TREE.each(function(e,t){var n=parseInt(t.id.replace(/\D+/gi,"")),o="tab-attribute",i=$("#attribute_group_tree"+n),r=$('input[id = "sortOrder_attribute_group_tree'+n+'"]:checkbox').is(":checked"),a=$('input[id = "lazyLoad_attribute_group_tree'+n+'"]:checkbox').is(":checked");i.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,extensions:["edit","dnd","filter"],selectMode:2,checkbox:!1,quicksearch:!0,source:{data:{user_token:user_token,token:token,language_id:n,sortOrder:r,lazyLoad:a,tree:"1",isPending:!1},url:"index.php?route="+extension+"module/attributico/getAttributeGroupTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},lazyLoad:function(e,t){t.result={data:{user_token:user_token,token:token,key:t.node.key,language_id:n},url:"index.php?route="+extension+"module/attributico/getLazyAttributeValues"}},edit:{triggerStart:["f2","shift+click","mac+enter"],inputCss:{minWidth:"18em"},beforeEdit:function(e,t){if(!t.node.permission(["group","attribute","template","value"]))return!1},edit:function(e,t){},beforeClose:function(e,t){},save:function(e,t){var o=t.node.getParent();return $.ajax({data:{user_token:user_token,token:token,key:t.node.key,name:t.input.val(),language_id:n,oldname:t.orgTitle},url:"index.php?route="+extension+"module/attributico/editAttribute"}).done(function(e){t.node.key.indexOf("template")+1?t.node.parent.isLazy()?o.getNextSibling().load(!0).done(function(e){reloadAttribute(t.node,!1)}):reloadAttribute(t.node,!0):t.node.key.indexOf("value")+1?t.node.parent.isLazy()?o.getPrevSibling().load(!0).done(function(e){o.load(!0).done(function(e){(t.node.tree.getNodeByKey(t.node.key)||t.node.getPrevSibling()||t.node.getNextSibling()).setActive()})}).done(function(e){reloadAttribute(t.node,!1)}):reloadAttribute(t.node,!0):reloadAttribute(t.node,!1),t.node.setTitle(e.acceptedTitle)}).fail(function(e){t.node.setTitle(t.orgTitle)}).always(function(){$(t.node.span).removeClass("pending")}),!0},close:function(e,t){t.save&&$(t.node.span).addClass("pending")}},dnd:{autoExpandMS:600,focusOnClick:!0,preventVoidMoves:!0,preventRecursiveMoves:!1,dragStart:function(e,t){return!(t.node.isRootNode()||t.node.getLevel()>3)},dragEnter:function(e,t){var n=e.getLevel(),o=t.otherNode.getLevel(),i=t.otherNode;return!(1===n||n>o)&&(e!==i.parent&&(!(e.parent===i.parent&&!t.tree.options.source.data.sortOrder&&!t.originalEvent.ctrlKey)&&(n!==o||t.originalEvent.ctrlKey?["over"]:["before","after"])))},dragDrop:function(e,t){var n=t.otherNode,o=e.getLevel(),i=n.getLevel(),r=!1,a=e.getParent()!==n.getParent(),d=t.originalEvent.ctrlKey&&o===i;d&&!confirm(textConfirm)||(selNodes?$.each(selNodes,function(n,o){d?o.remove():(o.moveTo(e,t.hitMode),r=!0)}):d?n.remove():n.moveTo(e,t.hitMode),d?(url="index.php?route="+extension+"module/attributico/mergeAttributeGroup",r=!0):a?(url="index.php?route="+extension+"module/attributico/replaceAttributeGroup",r=!1):url="index.php?route="+extension+"module/attributico/sortAttributeGroup",$.ajax({data:{user_token:user_token,token:token,subjects:selNodes?getSelectedKeys(selNodes):[n.key],group:e.getParent().key,target:e.key,direct:t.hitMode},url:url}).done(function(){reloadAttribute(n,r),deSelectNodes(n)}))},draggable:{scroll:!0}},beforeSelect:function(e,t){if(!selectControl(t))return!1},select:function(e,t){selNodes=t.tree.getSelectedNodes()},click:function(e,t){e.ctrlKey?t.node.toggleSelected():deSelectNodes(t.node)},keydown:function(e,t){let n=new KeydownCommand(e,t);n.permissions={remove:t.node.permission(["group","attribute","template","value"]),addChild:!0,addSibling:!0,copy:t.node.permission(["attribute"]),paste:!0},n.execute()},filter:{autoApply:!0,counter:!0,fuzzy:!1,hideExpandedCounter:!0,highlight:!0,mode:"dimm"},init:function(e,t){let i=new Filter(o,t.tree,n);i.attachEvents(),smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[n],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",o.permission(["group","attribute","template","value"])),t.tree.$div.contextmenu("enableEntry","rename",o.permission(["group","attribute","template","value"])),t.tree.$div.contextmenu("enableEntry","copy",!o.key.indexOf("attribute")),t.tree.$div.contextmenu("enableEntry","paste",!(0==clipboardNodes.length||o.getParent().isRootNode())),o.setActive()},select:function(e,t){let n=new ContextmenuCommand(t);n.execute()}})}})}),CATEGORY_TREE.each(function(e,t){var n=parseInt(t.id.replace(/\D+/gi,"")),o=$("#category_tree"+n),i=$('input[id = "sortOrder_category_tree'+n+'"]:checkbox').is(":checked");o.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,extensions:["dnd"],checkbox:!0,selectMode:$('input[id = "multiSelect_category_tree'+n+'"]:checkbox').is(":checked")?3:2,source:{data:{user_token:user_token,token:token,language_id:n,sortOrder:i},url:"index.php?route="+extension+"module/attributico/getCategoryTree"},activate:function(e,t){var o=$("#category_attribute_tree"+n).fancytree("getTree");currentCategory=t.node.key,o.reload({data:{user_token:user_token,token:token,language_id:n,category_id:currentCategory,sortOrder:$('input[id = "sortOrder_category_attribute_tree'+n+'"]:checkbox').is(":checked"),tree:"4"},url:"index.php?route="+extension+"module/attributico/getCategoryAttributeTree"})},dnd:{autoExpandMS:400,focusOnClick:!1,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:function(e,t){return!1},dragEnter:function(e,t){return t.otherNode.getParent().key!==e.key},dragDrop:function(e,t){addAttributeToCategory(e,t,t.otherNode.tree.$div.context.id.indexOf("attribute_tree"))}},select:function(e,t){selCategories=t.tree.getSelectedNodes(),t.tree.options.autoCollapse=!1,t.node.setExpanded(!(t.node.expanded&&!selCategories.length))},keydown:function(e,t){let n=new KeydownCommand(e,t);n.permissions={remove:!1,addChild:!1,addSibling:!1,copy:!1,paste:!0},n.execute()},focusTree:function(e,t){t.tree.$container.focus()},init:function(e,t){smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[n],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",!1),t.tree.$div.contextmenu("enableEntry","rename",!1),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","addChild",!1),t.tree.$div.contextmenu("enableEntry","paste",!(0==clipboardNodes.length||o.getParent().isRootNode())),o.setActive()},select:function(e,t){let n=new ContextmenuCommand(t);n.execute()}})}})}),CATEGORY_ATTRIBUTE_TREE.each(function(e,t){var n=parseInt(t.id.replace(/\D+/gi,"")),o=$("#category_attribute_tree"+n),i=$('input[id = "sortOrder_category_attribute_tree'+n+'"]:checkbox').is(":checked");o.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,selectMode:2,extensions:["edit","dnd"],source:{data:{user_token:user_token,token:token,language_id:n,category_id:currentCategory,sortOrder:i,tree:"4"},url:"index.php?route="+extension+"module/attributico/getCategoryAttributeTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},lazyLoad:function(e,t){t.result={data:{user_token:user_token,token:token,key:t.node.key,language_id:n},url:"index.php?route="+extension+"module/attributico/getLazyAttributeValues"}},edit:{triggerStart:[],inputCss:{minWidth:"18em"},beforeEdit:function(e,t){if(!t.isNew)return!1},edit:function(e,t){t.input.dropmenu({source:function(e,t){$.ajax({data:{user_token:user_token,token:token,filter_name:encodeURIComponent(e),language_id:n},url:"index.php?route="+extension+"module/attributico/autocomplete",dataType:"json",success:function(e){t($.map(e,function(e){return{category:e.attribute_group,label:e.name,value:e.attribute_id}}))}})},select:function(e){t.input.val(e.label),t.node.key="attribute_"+e.value}})},beforeClose:function(e,t){},save:function(e,t){return $.ajax({data:{attributes:[t.node.key],category_id:t.node.getParent().key,categories:selCategories?getSelectedKeys(selCategories):[t.node.getParent().key]},url:"index.php?route="+extension+"module/attributico/addCategoryAttributes&user_token="+user_token+"&token="+token,type:"POST"}).done(function(){$(t.node.span).removeClass("pending"),t.node.setTitle(t.node.title),reactivateCategory(t.node.getParent())}),!0},close:function(e,t){t.save&&$(t.node.span).addClass("pending")}},dnd:{autoExpandMS:400,focusOnClick:!1,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:function(e,t){return!0},dragEnter:function(e,t){return e.tree!==t.otherNode.tree&&!(e.getLevel()>2)},dragDrop:function(e,t){addAttributeToCategory(e.getParent().isRootNode()?e:e.getParent(),t,!1)}},beforeSelect:function(e,t){if(!selectControl(t))return!1},select:function(e,t){selNodes=t.tree.getSelectedNodes()},click:function(e,t){e.ctrlKey?t.node.toggleSelected():deSelectNodes(t.node)},keydown:function(e,t){let n=new KeydownCommandCategory(e,t);n.permissions={remove:!t.node.key.indexOf("attribute"),addChild:!0,addSibling:!1,copy:!t.node.key.indexOf("attribute"),paste:!0},n.execute()},focusTree:function(e,t){t.tree.$container.focus()},init:function(e,t){smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[n],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",!o.key.indexOf("attribute")),t.tree.$div.contextmenu("enableEntry","rename",!1),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","copy",!o.key.indexOf("attribute")),t.tree.$div.contextmenu("enableEntry","paste",!(0==clipboardNodes.length)),o.setActive()},select:function(e,t){let n=new ContextmenuCommandCategory(t);n.execute()}})}})}),ATTRIBUTE_TREE.each(function(e,t){var n="tab-category",o=parseInt(t.id.replace(/\D+/gi,"")),i=$("#attribute_tree"+o),r=$('input[id = "sortOrder_attribute_tree'+o+'"]:checkbox').is(":checked"),a=$('input[id = "lazyLoad_attribute_tree'+o+'"]:checkbox').is(":checked");i.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,extensions:["dnd","filter"],selectMode:2,checkbox:!1,quicksearch:!0,source:{data:{user_token:user_token,token:token,language_id:o,sortOrder:r,lazyLoad:a,isPending:!1,tree:"3"},url:"index.php?route="+extension+"module/attributico/getAttributeGroupTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},lazyLoad:function(e,t){t.result={data:{user_token:user_token,token:token,key:t.node.key,language_id:o},url:"index.php?route="+extension+"module/attributico/getLazyAttributeValues"}},dnd:{autoExpandMS:800,focusOnClick:!0,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:function(e,t){return 3===t.node.getLevel()},draggable:{revert:!0,cursorAt:{top:-5,left:-5},connectToFancytree:!0,appendTo:"body",scroll:!0}},beforeSelect:function(e,t){if(!selectControl(t))return!1},select:function(e,t){selNodes=t.tree.getSelectedNodes()},click:function(e,t){e.ctrlKey?t.node.toggleSelected():deSelectNodes(t.node)},keydown:function(e,t){let n=new KeydownCommand(e,t);n.permissions={remove:!1,addChild:!1,addSibling:!1,copy:!t.node.key.indexOf("attribute"),paste:!1},n.execute()},filter:{autoApply:!0,counter:!0,fuzzy:!1,hideExpandedCounter:!0,highlight:!0,mode:"dimm"},init:function(e,t){let i=new Filter(n,t.tree,o);i.attachEvents(),smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[o],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",!1),t.tree.$div.contextmenu("enableEntry","rename",!1),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","addChild",!1),t.tree.$div.contextmenu("enableEntry","copy",!o.key.indexOf("attribute")),o.setActive()},select:function(e,t){let n=new ContextmenuCommand(t);n.execute()}})}})}),DUTY_ATTRIBUTE_TREE.each(function(e,t){var n=parseInt(t.id.replace(/\D+/gi,"")),o=$("#duty_attribute_tree"+n),i="tab-duty",r=$('input[id = "sortOrder_duty_attribute_tree'+n+'"]:checkbox').is(":checked"),a=$('input[id = "lazyLoad_duty_attribute_tree'+n+'"]:checkbox').is(":checked");o.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,extensions:["edit","filter"],checkbox:!1,quicksearch:!0,source:{data:{user_token:user_token,token:token,language_id:n,sortOrder:r,lazyLoad:a,isPending:!1,tree:"2"},url:"index.php?route="+extension+"module/attributico/getAttributeGroupTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},lazyLoad:function(e,t){t.result={data:{user_token:user_token,token:token,key:t.node.key,language_id:n},url:"index.php?route="+extension+"module/attributico/getLazyAttributeValues"}},edit:{triggerStart:["f2","shift+click","mac+enter"],inputCss:{minWidth:"18em"},beforeEdit:function(e,t){if(!t.node.permission(["group","attribute","duty"]))return!1},save:function(e,t){var o=t.node.getParent();return $.ajax({data:{user_token:user_token,token:token,key:t.node.key,name:t.input.val(),language_id:n,oldname:t.orgTitle},url:"index.php?route="+extension+"module/attributico/editAttribute"}).done(function(e){t.node.key.indexOf("template")+1?o.getNextSibling().load(!0).done(function(e){reloadAttribute(t.node,!1)}):t.node.key.indexOf("value")+1?o.getPrevSibling().load(!0).done(function(e){o.load(!0).done(function(e){(t.node.tree.getNodeByKey(t.node.key)||t.node.getPrevSibling()||t.node.getNextSibling()).setActive()})}).done(function(e){reloadAttribute(t.node,!1)}):reloadAttribute(t.node,!1),t.node.setTitle(e.acceptedTitle)}).fail(function(e){t.node.setTitle(t.orgTitle)}).always(function(){$(t.node.span).removeClass("pending")}),!0},close:function(e,t){t.save&&$(t.node.span).addClass("pending")}},beforeSelect:function(e,t){return!1},keydown:function(e,t){let n=new KeydownCommandDuty(e,t);n.permissions={remove:t.node.permission(["duty"]),addChild:!1,addSibling:!1,copy:!1,paste:!1},n.execute()},filter:{autoApply:!0,counter:!0,fuzzy:!1,hideExpandedCounter:!0,highlight:!0,mode:"dimm"},init:function(e,t){let o=new Filter(i,t.tree,n);o.attachEvents(),smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[n],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",o.permission(["duty"])),t.tree.$div.contextmenu("enableEntry","rename",o.permission(["group","attribute","duty"])),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","addChild",!1),o.setActive()},select:function(e,t){let n=new ContextmenuCommandDuty(t);n.execute()}})}})}),ATTRIBUTE_PRODUCT_TREE.each(function(e,t){var n="tab-products",o=parseInt(t.id.replace(/\D+/gi,"")),i=$("#attribute_product_tree"+o),r=$('input[id = "sortOrder_attribute_product_tree'+o+'"]:checkbox').is(":checked"),a=$('input[id = "lazyLoad_duty_attribute_tree'+o+'"]:checkbox').is(":checked");i.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,extensions:["filter"],selectMode:2,checkbox:!1,quicksearch:!0,source:{data:{user_token:user_token,token:token,language_id:o,sortOrder:r,lazyLoad:a,isPending:!1,tree:"5"},url:"index.php?route="+extension+"module/attributico/getAttributeGroupTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},beforeActivate:function(e,t){if(4===t.node.getLevel())return!1},activate:function(e,t){var n=$("#product_tree"+o).fancytree("getTree");n.reload({data:{user_token:user_token,token:token,language_id:o,attribute_id:t.node.key,title:t.node.title,sortOrder:r,invert:$('input[id = "diver_product_tree'+o+'"]:checkbox').is(":checked")},url:"index.php?route="+extension+"module/attributico/getProductTree"})},lazyLoad:function(e,t){t.result={data:{user_token:user_token,token:token,key:t.node.key,language_id:o},url:"index.php?route="+extension+"module/attributico/getLazyAttributeValues"}},beforeSelect:function(e,t){if(!selectControl(t))return!1},select:function(e,t){selNodes=t.tree.getSelectedNodes()},click:function(e,t){},keydown:function(e,t){let n=new KeydownCommand(e,t);n.permissions={remove:!1,addChild:!1,addSibling:!1,copy:!1,paste:!1},n.execute()},filter:{autoApply:!0,counter:!0,fuzzy:!1,hideExpandedCounter:!0,highlight:!0,mode:"dimm"},init:function(e,t){let i=new Filter(n,t.tree,o);i.attachEvents(),smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[o],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",!1),t.tree.$div.contextmenu("enableEntry","rename",!1),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","addChild",!1),t.tree.$div.contextmenu("enableEntry","copy",!1),t.tree.$div.contextmenu("enableEntry","paste",!1),o.setActive()},select:function(e,t){let n=new ContextmenuCommand(t);n.execute()}})}})}),PRODUCT_TREE.each(function(e,t){var n=parseInt(t.id.replace(/\D+/gi,"")),o=$("#product_tree"+n),i=$('input[id = "diver_product_tree'+n+'"]:checkbox').is(":checked");o.fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,source:{data:{user_token:user_token,token:token,language_id:n,invert:i},url:"index.php?route="+extension+"module/attributico/getProductTree"},loadError:function(e,t){var n=t.error;n.status&&n.statusText?(t.message="Ajax error: "+t.message,t.details="Ajax error: "+n.statusText+", status code = "+n.status):(t.message="Custom error: "+t.message,t.details="An error occurred during loading: "+n),console.log(t),console.log(n.responseText)},dblclick:function(e,t){if(t.node.getLevel()<=2)return t.node.setExpanded(!t.node.isExpanded()),!1;var o=$('input[id = "input-attributico_about_blank"]:checkbox').is(":checked"),i=$("#attribute_product_tree"+n).fancytree("getTree"),r=i.getActiveNode();o?($("#reload.alert-danger").show(),window.open("index.php?route=catalog/product/"+edit+"&user_token="+user_token+"&token="+token+"&product_id="+t.node.key.split("_")[1]+"&attribute_id="+r.key.split("_")[1],"_blank")):window.location.href="index.php?route=catalog/product/"+edit+"&user_token="+user_token+"&token="+token+"&product_id="+t.node.key.split("_")[1]+"&attribute_id="+r.key.split("_")[1]},click:function(e,t){},keydown:function(e,t){let n=new KeydownCommand(e,t);n.permissions={remove:!1,addChild:!1,addSibling:!1,copy:!1,paste:!1},n.execute()},focusTree:function(e,t){t.tree.$container.focus()},init:function(e,t){smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll"),t.tree.$div.contextmenu({delegate:"span.fancytree-title",menu:contextmenu[n],beforeOpen:function(e,n){let o=$.ui.fancytree.getNode(n.target);t.tree.$div.contextmenu("enableEntry","remove",!1),t.tree.$div.contextmenu("enableEntry","rename",!1),t.tree.$div.contextmenu("enableEntry","addSibling",!1),t.tree.$div.contextmenu("enableEntry","addChild",!1),t.tree.$div.contextmenu("enableEntry","copy",!1),t.tree.$div.contextmenu("enableEntry","paste",!1),o.setActive()},select:function(e,t){let n=new ContextmenuCommand(t);n.execute()}})}})})}function dutyUpgrade(){$.ajax({data:{user_token:user_token,token:token},url:"index.php?route="+extension+"module/attributico/dutyUpgrade",success:function(){location.reload()}})}function check_for_updates(){$.ajax({data:{user_token:user_token,token:token},url:"index.php?route="+extension+"module/attributico/check_for_updates",dataType:"json",success:function(e){$("#infoModal").modal("show"),e.errno?(console.log(e),$("#infoModal #modal-content").html(e.errmsg)):e.compare?($("#infoModal #modal-content").html(e.content.well),$("#infoModal #modal-content").append(e.content.copyright)):($("#infoModal #modal-content").html(e.content.news),$("#infoModal #modal-content").append(e.content.links),$("#infoModal #modal-content").append(e.content.copyright))}})}function apply(){$('[id ^= "tree"].settings').each(function(e,t){$(t).fancytree("getTree").generateFormElements()}),$(".alert-success, #error_warning.alert-danger").hide(),$.post($("#form-attributico").attr("action"),$("#form-attributico").serialize(),function(e){var t=$(e).find(".alert-success, #error_warning.alert-danger");if(t.length>0)$(".alert-before").before(t);else{var n=$(e).find('[selected="selected"]').val();$.post(n,"",function(e){var t=$(e).find(".alert-success, #error_warning.alert-danger");t.length>0&&$(".alert-before").before(t)})}$('input[id ^= "multiSelect"]:checkbox').prop("checked",$('input[name = "attributico_multiselect"]:checkbox').is(":checked")),$('input[id ^= "sortOrder"]:checkbox').prop("checked",$('input[name = "attributico_sortorder"]:checkbox').is(":checked")),$('input[id ^= "lazyLoad"]:checkbox').prop("checked",$('input[name = "attributico_lazyload"]:checkbox').is(":checked")),CATEGORY_TREE.each(function(e,t){var n=$("#"+t.id).fancytree("getTree");n.options.selectMode=$('input[id ^= "multiSelect"]:checkbox').is(":checked")?3:2}),CATEGORY_CHECK_TREE.each(function(e,t){var n=$("#"+t.id).fancytree("getTree");n.options.selectMode=$('input[id ^= "multiSelect"]:checkbox').is(":checked")?3:2}),ATTRIBUTE_SYNCRO_TREES.each(function(e,t){var n=$("#"+t.id).fancytree("getTree");n.options.source.data.sortOrder=$('input[id ^= "sortOrder"]:checkbox').is(":checked"),n.options.source.data.lazyLoad=$('input[id ^= "lazyLoad"]:checkbox').is(":checked"),n.options.source.data.category_id=currentCategory,n.reload()})})}function tools(e){$('[id *= "tree"].options').each(function(e,t){$(t).fancytree("getTree").generateFormElements(!0,!0,{filter:null,stopOnParents:!1})}),$.ajax({data:{user_token:user_token,token:token,task:e,options:$("#form-attributico").serialize()},url:"index.php?route="+extension+"module/attributico/tools",beforeSend:function(){$("#column-2 .loader-img").show(),$("#column-2 .alert-success").hide(),$("#column-2 .alert-warning").show()},success:function(e){reloadAttribute(),reactivateCategory(),$("#column-2 .loader-img").hide(),$("#column-2 .alert-warning").hide(),$("#column-2 .alert-success").show(),$("#column-2 .alert-success").html(e)}})}$.ui.fancytree._FancytreeNodeClass.prototype.getParentByKey=function(e){e=null==e?null:""+e;var t=this;if(null!=e&&e!==this.key)for(;t.key.indexOf(e)&&!t.isRootNode();)t=t.getParent();return t.isRootNode()?null:t},$.ui.fancytree._FancytreeNodeClass.prototype.findUnselectedSibling=function(){for(var e=this.getNextSibling()||this.getPrevSibling()||this.getParent();e.isSelected()&&!e.isRootNode();)e=e.getPrevSibling()||e.getParent();return e},$.ui.fancytree._FancytreeNodeClass.prototype.getLanguageId=function(){var e=this.tree.$div.context.id,t=parseInt(e.replace(/\D+/gi,""));return t},$.ui.fancytree._FancytreeNodeClass.prototype.permission=function(e){let t=!1;for(let n=0;n<e.length;n++)t=t||!this.key.indexOf(e[n])&&!this.unselectable;return t};class ContextmenuCommand{
constructor(e){this.ui=e,this.node=$.ui.fancytree.getNode(e.target),this.tree=$.ui.fancytree.getTree(e.target),this.selector=this.tree.$div.context.id,this.lng_id=parseInt(this.selector.replace(/\D+/gi,""))}execute(){switch(this.ui.cmd){case"expande":case"collapse":this.tree.visit(function(e){e.setExpanded(!e.isExpanded())});break;case"options":$("#options_"+this.selector).dialog("open");break;case"rename":this.node.editStart();break;case"remove":if(!confirm(textConfirm))break;this.remove();break;case"addChild":1!==this.node.getLevel()&&this.addChild();break;case"addSibling":this.addSibling();break;case"copy":copyPaste(this.ui.cmd,this.node);break;case"paste":copyPaste(this.ui.cmd,this.node),deSelectNodes(this.node);break;default:alert("Todo: appply action '"+this.ui.cmd+"' to node "+this.node)}}remove(){deleteAttribute(this.node)}addChild(){addAttribute(this.node,"attribute",this.lng_id)}addSibling(){addAttribute(this.node,"group",this.lng_id)}}class ContextmenuCommandCategory extends ContextmenuCommand{remove(){deleteAttributesFromCategory(this.node)}addChild(){this.tree.getRootNode().getFirstChild().editCreateNode("child")}}class ContextmenuCommandDuty extends ContextmenuCommand{remove(){deleteDuty(this.node)}}class KeydownCommand{constructor(e,t){this.e=e,this.node=t.node,this.tree=t.tree,this.selector=this.tree.$div.context.id,this.lng_id=parseInt(this.selector.replace(/\D+/gi,"")),this.access={remove:!0,addChild:!0,addSibling:!0,copy:!0,paste:!0}}set permissions(e){this.access=e}execute(){switch(this.e.which){case 68:this.e.altKey&&(console.log("Debug mode: "),$.ajax({data:{user_token:user_token,token:token},url:"index.php?route="+extension+"module/attributico/debugSwitch",success:function(e){console.log(e)}}));break;case 66:this.e.ctrlKey&&this.tree.visit(function(e){e.setExpanded(!e.isExpanded())});break;case 46:this.access.remove&&confirm(textConfirm)&&this.remove();break;case 77:this.access.addSibling&&this.e.ctrlKey&&this.addSibling();break;case 81:this.access.addChild&&this.e.ctrlKey&&this.addChild();break;case 67:if(this.access.copy&&this.e.ctrlKey)return copyPaste("copy",this.node),!1;break;case 86:if(this.access.paste&&this.e.ctrlKey)return copyPaste("paste",this.node),deSelectNodes(this.node),!1}}remove(){deleteAttribute(this.node)}addChild(){addAttribute(this.node,"attribute",this.lng_id)}addSibling(){addAttribute(this.node,"group",this.lng_id)}}class KeydownCommandCategory extends KeydownCommand{remove(){deleteAttributesFromCategory(this.node)}addChild(){this.tree.getRootNode().getFirstChild().editCreateNode("child")}}class KeydownCommandDuty extends KeydownCommand{remove(){deleteDuty(this.node)}}class Filter{constructor(e,t,n){this.data={tab:e,tree:t,lng_id:n},this.input=$("input[name="+this.data.tab+"_search"+this.data.lng_id+"]"),this.btnSearch=$("button#"+this.data.tab+"_btnSearch"+this.data.lng_id),this.btnResetSearch=$("button#"+this.data.tab+"_btnResetSearch"+this.data.lng_id),this.checkbox=$("div#"+this.data.tab+"_filter"+this.data.lng_id+" input:checkbox"),this.autoComplete=$("input#fs"+this.data.tab+"_autoComplete"+this.data.lng_id)}attachEvents(){this.input.keyup(this.data,this.search).focus(),this.btnSearch.click(this.data,this.search),this.checkbox.change(this.data,this.changeSettings),this.btnResetSearch.click(this.data,this.clear).attr("disabled",!0),this.btnSearch.attr("disabled",this.autoComplete.is(":checked")),$("a[id ^=f_"+this.data.tab+this.data.lng_id+"]").click(this.data,this.action)}clear(e){e.data.tree.isFilterActive()&&(e.data.tree.clearFilter(),$("input[name *= "+e.data.tab+"_search"+e.data.lng_id+"]").val(""),$("span[id *= "+e.data.tab+"_matches"+e.data.lng_id+"]").text(""),$("[id ^=loadImg]").hide())}changeSettings(e){let t=$(this).attr("id"),n=$(this).is(":checked");switch(t){case"fs_"+e.data.tab+"_autoExpand"+e.data.lng_id:case"fs_"+e.data.tab+"_regex"+e.data.lng_id:case"fs_"+e.data.tab+"_leavesOnly"+e.data.lng_id:case"fs_"+e.data.tab+"_attributesOnly"+e.data.lng_id:break;case"fs_"+e.data.tab+"_autoComplete"+e.data.lng_id:$("button#"+e.data.tab+"_btnSearch"+e.data.lng_id).attr("disabled",$(this).is(":checked"));break;case"fs_"+e.data.tab+"_hideMode"+e.data.lng_id:e.data.tree.options.filter.mode=n?"hide":"dimm";break;case"fs_"+e.data.tab+"_counter"+e.data.lng_id:case"fs_"+e.data.tab+"_fuzzy"+e.data.lng_id:case"fs_"+e.data.tab+"_hideExpandedCounter"+e.data.lng_id:case"fs_"+e.data.tab+"_highlight"+e.data.lng_id:e.data.tree.options.filter[t.replace(/\d/g,"")]=n}e.data.tree.clearFilter(),$("input[name="+e.data.tab+"_search"+e.data.lng_id+"]").trigger("keyup")}search(e){let t=e.data.tab,n=e.data.lng_id,o=e.data.tree,i=0,r={autoExpand:$("#fs_"+t+"_autoExpand"+n).is(":checked"),leavesOnly:$("#fs_"+t+"_leavesOnly"+n).is(":checked")},a=$("#fs_"+t+"_attributesOnly"+n).is(":checked"),d=$("input[name="+t+"_search"+n+"]").val();e&&e.which===$.ui.keyCode.ESCAPE||""===$.trim(d)?$("button#"+t+"_btnResetSearch"+n).click():($("#fs_"+t+"_autoComplete"+n).is(":checked")||"keyup"!==e.type)&&(a||o.options.source.data.isPending||(o.visit(function(e){e.isLazy()&&e.load(!0)}),o.options.source.data.isPending=!0),setTimeout(()=>{$("#fs_"+t+"_regex"+n).is(":checked")?(i=o.filterNodes(function(e){return new RegExp(d,"i").test(e.title)},r),$("span#"+t+"_matches"+n).text("("+i+")")):(i=o.filterNodes(d,r),$("span#"+t+"_matches"+n).text("("+i+")"))},600),$("button#"+t+"_btnResetSearch"+n).attr("disabled",!1),$("span#"+t+"_matches"+n).text("("+i+")"))}action(e){let t=e.data.tab,n=e.data.lng_id,o=$("button#"+t+"_btnSearch"+n),i=$("button#"+t+"_btnResetSearch"+n),r=$("div#"+t+"_searchmode"+n+" input#fs_"+t+"_regex"+n+":checkbox"),a=$("input[name="+t+"_search"+n+"]");switch(r.prop({checked:!0}),e.target.id){case"f_"+t+n+"_empty":a.val("^s*$"),o.trigger("click");break;case"f_"+t+n+"_digital":a.val("[0-9]"),o.trigger("click");break;case"f_"+t+n+"_html":a.val("<[^>]+>"),o.trigger("click");break;case"f_"+t+n+"_default":r.prop({checked:!1}),i.trigger("click")}return!1}}var clipboardNodes=[],clipboardTitles=[],pasteMode=null;(function(e){e.fn.dropmenu=function(t){return this.each(function(){this.timer=null,this.items=new Array,$div=e("<div />"),$ul=e("<ul class='drop-menu' />"),$menu=$ul,e.extend(this,t),e(this).attr("autocomplete","off"),e(this).on("focus",function(e){e.preventDefault(),this.request()}),e(this).on("blur",function(){setTimeout(function(e){e.hide()},200,this)}),e(this).on("keydown",function(e){switch(e.preventDefault(),e.keyCode){case 27:this.hide();break;default:this.request()}}),e(this).on("mousedown",function(t){t.preventDefault(),t.stopPropagation(),e(this).focus()}),this.click=function(t){t.preventDefault(),value=e(t.target).parent().attr("data-value"),value&&this.items[value]&&this.select(this.items[value])},this.show=function(){var t=e(this).position();e(this).siblings("div").children($menu).css({top:t.top+e(this).outerHeight(),left:t.left}),e(this).siblings("div").children($menu).show()},this.hide=function(){e(this).siblings("div").children($menu).hide()},this.request=function(){clearTimeout(this.timer),this.timer=setTimeout(function(t){t.source(e(t).val(),e.proxy(t.response,t))},200,this)},this.response=function(t){if(html="",t.length){for(i=0;i<t.length;i++)this.items[t[i].value]=t[i];for(i=0;i<t.length;i++)t[i].category||(html+='<li data-value="'+t[i].value+'"><a href="#">'+t[i].label+"</a></li>");var n=new Array;for(i=0;i<t.length;i++)t[i].category&&(n[t[i].category]||(n[t[i].category]=new Array,n[t[i].category].name=t[i].category,n[t[i].category].item=new Array),n[t[i].category].item.push(t[i]));for(i in n)for(html+='<li class="drop-header">'+n[i].name+"</li>",j=0;j<n[i].item.length;j++)html+='<li data-value="'+n[i].item[j].value+'"><a href="#">&nbsp;&nbsp;&nbsp;'+n[i].item[j].label+"</a></li>"}html?this.show():this.hide(),e(this).siblings("div").children($menu).html(html)},e(this).after($div),$menu.appendTo($div),e(this).siblings("div").children($menu).delegate("a","mousedown",e.proxy(this.click,this))})}})(window.jQuery),$(function(){$('[id ^= "tree"]').each(function(e,t){$(t).fancytree({checkbox:!0,selectMode:2,source:{data:{user_token:user_token,token:token,tree:e+1},url:"index.php?route="+extension+"module/attributico/getChildrenSettings"}})}),GROUP_CHECK_TREE.each(function(e,t){var n=$('input[name = "attributico_sortorder"]:checkbox').is(":checked");$(t).fancytree({checkbox:!0,selectMode:3,autoScroll:!0,source:{data:{user_token:user_token,token:token,sortOrder:n,onlyGroup:!0,isPending:!1},url:"index.php?route="+extension+"module/attributico/getAttributeGroupTree"},init:function(e,t){smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll")}})}),CATEGORY_CHECK_TREE.each(function(e,t){var n=$('input[name = "attributico_sortorder"]:checkbox').is(":checked");$(t).fancytree({autoCollapse:!0,autoScroll:!0,minExpandLevel:2,checkbox:!0,selectMode:$('input[id = "input-attributico_multiselect"]:checkbox').is(":checked")?3:2,source:{data:{user_token:user_token,token:token,sortOrder:n},url:"index.php?route="+extension+"module/attributico/getCategoryTree"},init:function(e,t){smartScroll.is(":checked")&&t.tree.$container.addClass("smart-scroll")}})}),$("#form-attributico").submit(function(){$('[id ^= "tree"].settings').each(function(e,t){$(t).fancytree("getTree").generateFormElements()})}),$('a[data-toggle="pill"]').on("shown.bs.tab",function(e){$("#column-2 .alert-success").hide(),$("#column-2 .task-complete").hide(),$("#column-2 .alert-info").show()}),$('[name = "attributico_product_text"]').each(function(e,t){$('[name = "attributico_autoadd"]').is(":checked")||$(t).prop({disabled:!0,checked:!1})}),$('input[name = "attributico_autoadd"]:checkbox').change(function(e){flag=$(this).is(":checked"),$('[name = "attributico_product_text"]').each(function(e,t){$(t).prop({disabled:!flag})})}),$('input[name = "attributico_smart_scroll"]:checkbox').change(function(e){$(this).is(":checked")?$('[id *= "tree"]:not(.settings) > ul.fancytree-container').addClass("smart-scroll"):$("ul.fancytree-container").removeClass("smart-scroll")}),$('input[name = "attributico_cache"]:checkbox').change(function(e){$.ajax({data:{user_token:user_token,token:token},url:"index.php?route="+extension+"module/attributico/cacheDelete",success:function(e){let t=CATEGORY_SYNCRO_TREES.size();CATEGORY_SYNCRO_TREES.each(function(e,n){var o=$("#"+n.id).fancytree("getTree");o.options.source.data.cache=$('input[name = "attributico_cache"]:checkbox').is(":checked"),o.reload().done(function(){o.options.source.data.isPending=!1,e+1==t&&reloadAttribute()})})}})}),$('input[name = "attributico_multistore"]:checkbox').change(function(e){$.ajax({data:{user_token:user_token,token:token},url:"index.php?route="+extension+"module/attributico/cacheDelete",success:function(e){let t=CATEGORY_SYNCRO_TREES.size();CATEGORY_SYNCRO_TREES.each(function(e,n){var o=$("#"+n.id).fancytree("getTree");o.options.source.data.multistore=$('input[name = "attributico_multistore"]:checkbox').is(":checked"),o.reload().done(function(){o.options.source.data.isPending=!1,e+1==t&&reloadAttribute()})})}})}),$('[id *= "options_"]').dialog({autoOpen:!1,resizable:!1,modal:!0,buttons:[{icons:{primary:"ui-icon-check"},class:"hawt-button",title:"Apply",click:function(){$(this).dialog("close")}}]}),$('input[id ^= "lazyLoad"]:checkbox').change(function(e){var t=$(this).attr("id"),n=$("#"+t.replace("lazyLoad_","")).fancytree("getTree"),o=$(this).is(":checked");n.options.source.data.lazyLoad=o,n.reload()}),$('input[id ^= "sortOrder"]:checkbox').change(function(e){var t=$(this).attr("id"),n=$("#"+t.replace("sortOrder_","")).fancytree("getTree"),o=$(this).is(":checked");n.options.source.data.sortOrder=o,n.options.source.data.category_id=currentCategory,n.reload()}),$('input[id ^= "autoCollapse"]:checkbox').change(function(e){var t=$(this).attr("id"),n=$(this).is(":checked");$("#"+t.replace("autoCollapse_","")).fancytree("getTree").options.autoCollapse=n}),$('input[id ^= "multiSelect"]:checkbox').change(function(e){var t=$(this).attr("id"),n=$("#"+t.replace("multiSelect_","")).fancytree("getTree");n.options.selectMode=$(this).is(":checked")?3:2}),$('input[id ^= "diver"]:checkbox').change(function(e){var t=$(this).attr("id"),n=parseInt(t.replace(/\D+/gi,"")),o=$("#attribute_product_tree"+n).fancytree("getTree");o.reactivate()})});